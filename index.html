<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram WebApp Fullscreen</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            transition: filter 0.3s ease, opacity 0.3s ease;
            position: relative;
            height: 100vh;
            /* Используем 100vh для правильной адаптации */
            overflow: hidden;
        }

        h1 {
            color: #333;
            margin-top: 20px;
        }

        #image-container {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            background-color: black;
            z-index: -1;
        }

        #main-image {
            object-fit: cover;
            width: 100%;
            height: 100%;
            transition: filter 0.3s ease, opacity 0.3s ease;
        }

        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: black;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 9999;
            pointer-events: none;
        }
    </style>
</head>

<body>
    <h1>Protected WebApp</h1>
    <div id="image-container">
        <img id="main-image"
            src="https://images.unsplash.com/photo-1604524425934-268046c64359?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwzNjUyOXwwfDF8c2VhY2h8MXx8bW91bnRhaW5oYWx8ZW58MHx8fHwxNjA2Nzg2NzQ0&ixlib=rb-1.2.1&q=80&w=1080"
            alt="Mountains">
    </div>

    <div id="overlay"></div>

    <script>
        // Ждем загрузки DOM перед запуском WebApp
        document.addEventListener('DOMContentLoaded', function () {
            if (window.Telegram && window.Telegram.WebApp) {
                // Разворачиваем WebApp на весь экран
                window.Telegram.WebApp.expand();
            }
        });

        const tg = window.Telegram.WebApp;

        // === Размытие контента при переключении окон ===
        document.addEventListener("visibilitychange", () => {
            if (document.hidden) {
                document.getElementById("main-image").style.filter = "blur(30px)";
            } else {
                document.getElementById("main-image").style.filter = "none";
            }
        });

        // === Блокировка скриншотов: затемнение экрана ===
        function blockScreenshot() {
            document.getElementById("overlay").style.opacity = "1";  // Затемняем экран
            setTimeout(() => {
                document.getElementById("overlay").style.opacity = "0";  // Убираем затемнение через 1 сек
            }, 1000);
        }

        // Перехватываем сочетание клавиш скриншота (работает в большинстве браузеров)
        window.addEventListener("keydown", (e) => {
            if (e.key === "PrintScreen") {
                blockScreenshot();
            }
        });

        // Перехватываем попытку сделать снимок экрана на мобильных устройствах
        window.addEventListener("blur", () => {
            blockScreenshot();
        });
    </script>
</body>

</html>